@startuml
title C4 L4 - Code (US 4.1.6 - core classes)

class ResourceAllocationService {
  - repo: IOperationPlanRepository
  + getAllocationSummary(resourceId, type, from, to): AllocationSummary
}

interface IOperationPlanRepository {
  + findByResourceAndPeriod(resourceId, type, from, to): List<OperationPlan>
}

class MongoOperationPlanRepository {
  + findByResourceAndPeriod(...): List<OperationPlan>
}

class OperationPlan {
  + operations: List<PlannedOperation>
}

class PlannedOperation {
  + startTime
  + endTime
  + durationMinutes(): int
  + resources: List<ResourceRef>
}

class ResourceRef {
  + resourceId
  + type
}

class AllocationSummary {
  + totalAllocatedMinutes
  + operationCount
}

ResourceAllocationService --> IOperationPlanRepository
IOperationPlanRepository <|.. MongoOperationPlanRepository
ResourceAllocationService ..> AllocationSummary
OperationPlan "1" o-- "*" PlannedOperation
PlannedOperation "*" o-- "*" ResourceRef

@enduml
